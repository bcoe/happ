{"version":3,"file":"habits-j5W6WtxL.js","sources":["../../../app/providers/habits.tsx"],"sourcesContent":["import * as React from \"react\";\n\nexport interface HabitType {\n  name: string;\n  habit_id: string;\n  id: string;\n  status: boolean;\n  date: string;\n}\n\ninterface HabitsType {\n  habits: Array<HabitType>; \n  empty: boolean;\n  editing: boolean;\n  setEditing: (editing: boolean) => Promise<void>;\n  load: () => Promise<void>;\n  create: (name: string) => Promise<void>;\n  set: (habits: Array<HabitType>) => {};\n  toggle: (id: string) => Promise<void>;\n  move: (oldIndex: number, newIndex: number) => Promise<void>;\n}\n\nconst HabitsContext = React.createContext<HabitsType>(null!);\n\nexport function HabitsProvider({ children }: { children: React.ReactNode }) {\n  const [habits, setHabits] =  React.useState<Array<HabitType>>([]);\n  const [empty, setEmpty] = React.useState<boolean>(false);\n  const [editing, _setEditing] = React.useState<boolean>(false);\n\n  const set = (habits: Array<HabitType>) => {\n    setHabits([...habits]);\n    /*\n      setHabits([\n        {\n          name: 'get up without hitting snooze',\n          habit_id: 'abc-123',\n          id: 'abc-123',\n          status: true,\n          date: '10-10-1983'\n        },\n        {\n          name: 'take finn for walk',\n          habit_id: 'abc-124',\n          id: 'abc-124',\n          status: true,\n          date: '10-10-1983'\n        },\n        {\n          name: 'make breakfast at home',\n          habit_id: 'abc-125',\n          id: 'abc-124',\n          status: true,\n          date: '10-10-1983'\n        }\n      ]);\n    */\n    setEmpty(!habits.length);\n    return {}\n  }\n\n  const create = async (name: string) => {\n    await fetch('/v1/habits', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({name})\n    });\n  }\n\n  const toggle = async (id: string) => {\n    const habit = habits.find((h) => {\n      if (h.id === id) return true;\n    })\n    if (!habit) return;\n    await fetch('/v1/habits-daily', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        habit_id: habit.habit_id,\n        status: !habit.status,\n        date: habit.date,\n      })\n    });\n  }\n\n  const move = async (oldIndex: number, newIndex: number) => {\n    await fetch('/v1/habits/array-move', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        oldIndex,\n        newIndex\n      })\n    });\n  }\n\n  const load = async () => {\n    const resp = await fetch(\"/v1/habits-daily\");\n    const habits = await resp.json();\n    habits.map((h) => {\n      h.id = h.habit_id;\n    });\n    set(habits);\n  }\n\n  const setEditing = async (editing: boolean) => {\n    _setEditing(editing);\n  }\n\n  const value = { habits, empty, editing, setEditing, load, set, create, toggle, move };\n\n  return <HabitsContext.Provider value={value}>{children}</HabitsContext.Provider>;\n}\n\nexport function useHabits() {\n  return React.useContext(HabitsContext);\n}\n"],"names":["HabitsContext","React.createContext","HabitsProvider","children","habits","setHabits","React.useState","empty","setEmpty","editing","_setEditing","set","value","h","name","id","habit","oldIndex","newIndex","jsx","useHabits","React.useContext"],"mappings":"4WAsBA,MAAMA,EAAgBC,EAAAA,cAAgC,IAAK,EAE3C,SAAAC,EAAe,CAAE,SAAAC,GAA2C,CAC1E,KAAM,CAACC,EAAQC,CAAS,EAAKC,EAAM,SAA2B,CAAE,CAAA,EAC1D,CAACC,EAAOC,CAAQ,EAAIF,WAAwB,EAAK,EACjD,CAACG,EAASC,CAAW,EAAIJ,WAAwB,EAAK,EAEtDK,EAAOP,IACDC,EAAA,CAAC,GAAGD,CAAM,CAAC,EA0BZI,EAAA,CAACJ,EAAO,MAAM,EAChB,IAyDHQ,EAAQ,CAAE,OAAAR,EAAQ,MAAAG,EAAO,QAAAE,EAAS,WAJrB,MAAOA,GAAqB,CAC7CC,EAAYD,CAAO,CAAA,EAG+B,KAbvC,SAAY,CAEjBL,MAAAA,EAAS,MADF,MAAM,MAAM,kBAAkB,GACjB,OAC1BA,EAAO,IAAKS,GAAM,CAChBA,EAAE,GAAKA,EAAE,QAAA,CACV,EACDF,EAAIP,CAAM,CAAA,EAO8C,IAAAO,EAAK,OAtDhD,MAAOG,GAAiB,CACrC,MAAM,MAAM,aAAc,CACxB,OAAQ,OACR,QAAS,CACP,eAAgB,kBAClB,EACA,KAAM,KAAK,UAAU,CAAC,KAAAA,EAAK,CAAA,CAC5B,CAAA,EA+CoE,OA5CxD,MAAOC,GAAe,CACnC,MAAMC,EAAQZ,EAAO,KAAMS,GAAM,CAC/B,GAAIA,EAAE,KAAOE,EAAW,MAAA,EAAA,CACzB,EACIC,GACL,MAAM,MAAM,mBAAoB,CAC9B,OAAQ,OACR,QAAS,CACP,eAAgB,kBAClB,EACA,KAAM,KAAK,UAAU,CACnB,SAAUA,EAAM,SAChB,OAAQ,CAACA,EAAM,OACf,KAAMA,EAAM,IAAA,CACb,CAAA,CACF,CAAA,EA6B4E,KA1BlE,MAAOC,EAAkBC,IAAqB,CACzD,MAAM,MAAM,wBAAyB,CACnC,OAAQ,OACR,QAAS,CACP,eAAgB,kBAClB,EACA,KAAM,KAAK,UAAU,CACnB,SAAAD,EACA,SAAAC,CAAA,CACD,CAAA,CACF,CAAA,CAgBiF,EAEpF,OAAQC,EAAAA,IAAAnB,EAAc,SAAd,CAAuB,MAAAY,EAAe,SAAAT,CAAS,CAAA,CACzD,CAEO,SAASiB,GAAY,CACnB,OAAAC,EAAAA,WAAiBrB,CAAa,CACvC"}